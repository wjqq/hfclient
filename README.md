# hfclient



This is a Hello World project to query/invoke chaincode method.

* This is connected to the network generated by ./byfn.sh, which is shipped with fabric-sample project.
1 - Set up fabric-sample project(1.4.4) and start with command ./byfn.sh up, Before start to Instantiate the chain code, you should change the Endorsement policy to '[ -P 'OR ('\''Org1MSP.peer'\'','\''Org2MSP.peer'\'')']' it is easy to do Endorsement in step 4, if not, you need to change invoke.js to send the transactions to all the peers(peer0.Org1 and peer1.Org2), otherwise you will get endorsement Error during the transaction send.

2 - Update the variable in the Invoke.js and Query.js based on you local environment.

3 - Run the node query.js which gets the balance of Account a.

4 - Run the node invoke.js which transfers 10 from a to b

NOTE: 
You should install the right version of node and nodejs, the version you can find out in the cli container(fabric-tools)
node version is v8.16.1
npm version is 6.4.1

If you are have node with different version, you can install 'n' if you are using Ubuntu, it can help you switch the node version by 'n ${version}', it's so handy tools.

* This is connected to the network generated by IBM extension, it is some different with the above network
1 - the network don't start TLS, so use the grpc protocal. for example peer: grpc://localhost:17051
2 - There are 2 places to gather the information that are needed to do connections to the blockchain.
  2.1 from the output of command "docker ps"
  2.2 from the connection profile, generate with the IBM plugin(right click the Fabric Gateways in the Plugin)
3 - If you want to user the user admin, you need to enroll it with CA with commamd below:
  fabric-ca-client enroll -u http://admin:adminpw@localhost:17054(not 7054)
  
  You can also build any other users as you want,
  3.1 use the commands belows:
    A.fabric-ca-client identity add user2 -u http://localhost:17054
    B.fabric-ca-client enroll -u http://user2:DHgxXsoCxjQz@localhost:17054
    
4 - Update the "options" variable in the file query.js as below, comment(remove) other properties in the "options" variable, and comment(remove) all the code refer to them as well, because, for example, we don't communicate nodes with TLS, so we don't need TLS certificates. 

var options = {
    user_id: 'admin', //the value is any
    msp_id: 'Org1MSP',
    channel_id: 'mychannel',
    chaincode_id: 'gy3',
    peer_url: 'grpc://localhost:17051',
    orderer_url: 'grpcs://localhost:17050',
    privateKeyFolder: 'C:/Users/WeiJia/.fabric-ca-client/msp/keystore', // the private key of the user(admin)
    signedCert: 'C:/Users/WeiJia/.fabric-ca-client/msp/signcerts/cert.pem' // the public key of the user(admin)
};

5 - run "node query_plugin.js"

AzureAD+WeiJia@LAPTOP-JW MINGW64 /c/e/rebuild/projects/blockchain/hfclient (master)
$ node query_plugin.js
Load privateKey and signedCert
Query has completed, checking results
Response is  46





  
  
  
  

